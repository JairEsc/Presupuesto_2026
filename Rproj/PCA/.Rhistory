View(indicadores)
"../../Inputs/base para acp.xlsx" |> openxlsx::read.xlsx()->indicadores
View(indicadores)
source("../Codigos/pre-procesamiento.R")
View(indicadores)
"../Datos/input.xlsx" |> openxlsx::read.xlsx()->indicadores
indicadores=NULL
"../Datos/input.xlsx" |> openxlsx::read.xlsx()->indicadores
View(indicadores)
View(diccionario_variables)
"../../Inputs/base para acp.xlsx" |> openxlsx::read.xlsx()->indicadores
#| echo: false
#| message: false
#| warning: false
#| fig-width: 16
#| fig-height: 7
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 16
#| fig-height: 7
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4,title = "Correlación. Da click para ver en grande")
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
View(indicadores)
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
matrix_corr=cor(indicadores[,-1])
View(matrix_corr)
matrix_corr=cor(indicadores[,-1])
View(matrix_corr)
##E.g. #indice de ingresos vs. porc. pob. con ingresos menores a linea de pobreza vs.
#marginacion y porcentaje de personas mayores a 15 años sin educacion básica.
# porcentaje de viviendas sin accesoa  inernet.
#Dado que muchas de ellas están involucradas en el cálculo de la marginación, la consideramos una medida resumen y la conservamos.
indicadores=indicadores |> dplyr::select(-ind_ingreso,-PORC_POB_IILP,-pje_pob_15ymas_edbasinc_2020,-Pje_vivnodinter_2020)
matrix_corr=cor(indicadores[,-1])
View(matrix_corr)
"../../Inputs/base para acp.xlsx" |> openxlsx::read.xlsx()->indicadores
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
source("../Codigos/post_seleccion_vars.R")
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
#| echo: false
#| message: false
#| warning: false
library(DT)
DT::datatable(diccionario_variables)
diccionario_variables[nrow(diccionario_variables)+1,]
View(diccionario_variables)
diccionario_variables[nrow(diccionario_variables)+1,]=c(	'DRIOPAP_T','Total de denuncias recibidas por incumplimiento de las obligaciones del personal adscrito a las instituciones de la Administración Pública	INEGI','Control Interno y Anticorrupcion')
View(diccionario_variables)
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
#| echo: false
#| message: false
#| warning: false
library(DT)
DT::datatable(diccionario_variables)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 16
#| fig-height: 7
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4,title = "Correlación. Da click para ver en grande")
View(indicadores)
"../../Inputs/base para acp.xlsx" |> openxlsx::read.xlsx()->indicadores
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
#"../Datos/input.xlsx" |> openxlsx::read.xlsx()->indicadores
source("../../../../Reutilizables/Postgres_BUIG/conexion_buig.R")
#"../Datos/input.xlsx" |> openxlsx::read.xlsx()->indicadores
#source("../../../../Reutilizables/Postgres_BUIG/conexion_buig.R")
viviendas_scince_2020municipal=st_read(buig,Lista_BUIG[[313]])
poblacion_scince_2020municipal=st_read(buig,Lista_BUIG[[230]])
poblacion_scince_2020municipal=poblacion_scince_2020municipal |>
dplyr::select(cve_mun,nomgeo,pob1) |> st_drop_geometry()
viviendas_scince_2020municipal=viviendas_scince_2020municipal |>
dplyr::select(cve_mun,nomgeo,viv2) |> st_drop_geometry()
indicadores=indicadores |>
merge(y=poblacion_scince_2020municipal |>
dplyr::select(nomgeo,pob1),by.x='NOM_MUN',by.y='nomgeo',all.x=T) |>
merge(y=viviendas_scince_2020municipal|>
dplyr::select(nomgeo,viv2),by.x='NOM_MUN',by.y='nomgeo')
indicadores=indicadores |>
dplyr::mutate(rsu_sin_rec=as.numeric(gsub(",","",rsu_sin_rec))/pob1,
ec_co2e=1000*as.numeric(gsub(",","",ec_co2e))/pob1,
pob_ben_beca=1000*as.numeric(gsub(",","",pob_ben_beca))/pob1,
VPH_NODREN=100*(VPH_NODREN/viv2),
personal_seguridad=1000*personal_seguridad/pob1,
TOT_INV_CARR=TOT_INV_CARR/pob1,
TOT_INV_AGUA=TOT_INV_AGUA/pob1,
TOT_INV_ESPE=TOT_INV_ESPE/pob1,
tot_del_fc=1000*tot_del_fc/pob1, #ni idea
Tiendas.liconsa=1000*Tiendas.liconsa/pob1,
SPDCD_T=as.numeric(SPDCD_T),
t_lamp_lumi_alumb_pub=as.numeric(gsub(" ","",t_lamp_lumi_alumb_pub))/pob1,
p_disp_seg=as.numeric(gsub(" ","",p_disp_seg)),
pres_eje_seg_mun=as.numeric(gsub(" ","",pres_eje_seg_mun))/pob1
)
"../../Inputs/base para acp.xlsx" |> openxlsx::read.xlsx()->indicadores
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
#| echo: false
#| message: false
#| warning: false
library(DT)
DT::datatable(diccionario_variables)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 16
#| fig-height: 7
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4,title = "Correlación. Da click para ver en grande")
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
indicadores=indicadores |>
dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
####-----------
# ingresos,  viviendas sin internet, marginacion, personas sin educacion basica,
#ingresos menores a la linea de pobreza,
#poblacion desocupada, pib estatal,
#Resumen: pobreza por ingresos.
##Componente 2:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2]#Cortamos a 8
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
####-----------
# ingresos,  viviendas sin internet, marginacion, personas sin educacion basica,
#ingresos menores a la linea de pobreza,
#poblacion desocupada, pib estatal,
#Resumen: pobreza por ingresos.
##Componente 2:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2]#Cortamos a 8
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
#Resumen.
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),4] #Cortamos a 4
View(diccionario_variables)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5] #Cortamos a 4
#Resumen.
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5] #Cortamos a 4
## - kilometros de carreteras, + unidades economicas, - areas verdes , + superficies de cosecha siniestradas
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,6] |> abs() |> order(decreasing = T),6]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,6] |> abs() |> order(decreasing = T),6] #Cortamos a 4
#Resumen.
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5] #Cortamos a 4
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
####-----------
# ingresos,  viviendas sin internet, marginacion, personas sin educacion basica,
#ingresos menores a la linea de pobreza,
#poblacion desocupada, pib estatal,
#Resumen: pobreza por ingresos.
##Componente 2:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2]#Cortamos a 8
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
#Resumen.
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5] #Cortamos a 4
summary(pca_indicadores_post)
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
####-----------
# ingresos,  viviendas sin internet, marginacion, personas sin educacion basica,
#ingresos menores a la linea de pobreza,
#poblacion desocupada, pib estatal,
#Resumen: pobreza por ingresos.
##Componente 2:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2]#Cortamos a 8
slice_top5(3)
source("../Codigos/pre-procesamiento.R")
source("../Codigos/post_seleccion_vars.R")
# indicadores=indicadores |>
#   dplyr::mutate(dplyr::across(GINI:pres_eje_seg_mun, ~tidyr::replace_na(., 0)))
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
summary(pca_indicadores_post)
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4,title = "Correlación. Da click para ver en grande")
var_explicada <- pca_indicadores_post$sdev^2
# Calculamos el porcentaje de varianza
proporcion_varianza <- var_explicada / sum(var_explicada)
# Creamos el data frame para la visualización
data_varianza <- data.frame(
PC = 1:length(proporcion_varianza),
Varianza = proporcion_varianza
)
library(ggplot2)
ggplot(data_varianza, aes(x = PC, y = Varianza)) +
geom_bar(stat = "identity", fill = "#F5DABC") +
geom_text(aes(label = paste0(round(Varianza * 100), "%")),
vjust = -0.5, size = 3) +
labs(x = "Componente Principal", y = "Proporción de Varianza Explicada") +
theme_minimal() +
ggtitle("Varianza Explicada por Componente Principal")
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1] |> abs() |> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,1] |> abs() |> order(decreasing = T),1]##Cortamos a 2
####-----------
# ingresos,  viviendas sin internet, marginacion, personas sin educacion basica,
#ingresos menores a la linea de pobreza,
#poblacion desocupada, pib estatal,
#Resumen: pobreza por ingresos.
##Componente 2:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,2] |> abs() |> order(decreasing = T),2]#Cortamos a 8
#slice_top5(3)
# + carencia alimentaria, - poco personal de seguridad, - alumbrado publico,
# - pob discapacitada,
#carencia acceso vivienda, baja inversion a carreteras, poblacion inactiva,tiendas liconsa, mucha enf_intestinales.
#Resumen: Medidad de seguridad y carencia alimentaria.
##Componente 3:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3] |> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,3] |> abs() |> order(decreasing = T),3]
#+ presencia de delitos, + participacion al pib, +inversion en escuelas, + poblacion desocupada
#- poblacion sin derechohabiencia
#, poca poblacion desocupada, pocas personas inactivas,
#Poco personal de seguridad, muchas superficies siniestradas, baja inversion en carreteras
#Resumen. Baja presencia de delitos, más participacion al pib
##Componente 4:
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,4] |> abs() |> order(decreasing = T),4] #Cortamos a 4
#Resumen.
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5]|> abs()|> plot()
pca_indicadores_post$rotation[pca_indicadores_post$rotation[,5] |> abs() |> order(decreasing = T),5] #Cortamos a 4
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 1:2,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
# Gráfico 2: Solo las 10 variables principales
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 3:4,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
#| echo: false
#| message: false
#| warning: false
#| include: false
source("../Codigos/pre-procesamiento.R")
#| echo: false
#| message: false
#| warning: false
library(DT)
DT::datatable(diccionario_variables)
#| echo: false
#| message: false
#| warning: false
#| fig-width: 16
#| fig-height: 7
library(ggcorrplot)
ggcorrplot::ggcorrplot(corr = round(cor(indicadores[,-1]),2),type = "lower",show.diag = F,lab = T,lab_size = 1.4,title = "Correlación. Da click para ver en grande")
source("../Codigos/post_seleccion_vars.R")
#| echo: false
pca_indicadores_post=prcomp(indicadores[,-1], scale = TRUE,retx = T)
#| echo: false
var_explicada <- pca_indicadores_post$sdev^2
# Calculamos el porcentaje de varianza
proporcion_varianza <- var_explicada / sum(var_explicada)
# Creamos el data frame para la visualización
data_varianza <- data.frame(
PC = 1:length(proporcion_varianza),
Varianza = proporcion_varianza
)
library(ggplot2)
ggplot(data_varianza, aes(x = PC, y = Varianza)) +
geom_bar(stat = "identity", fill = "#F5DABC") +
geom_text(aes(label = paste0(round(Varianza * 100), "%")),
vjust = -0.5, size = 3) +
labs(x = "Componente Principal", y = "Proporción de Varianza Explicada") +
theme_minimal() +
ggtitle("Varianza Explicada por Componente Principal")
#| echo: false
#| message: false
#| warning: false
#| layout-ncol: 2
#| fig-cap: "Contribución de las variables utilizadas para la composición de los primeros dos componentes"
library(factoextra)
# Gráfico 1: Todas las variables
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 1:2,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE)
#| echo: false
#| layout-ncol: 2
#| fig-cap: "Principales diez componentes en la composición de los componentes 1-4"
# Gráfico 2: Solo las 10 variables principales
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 1:2,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
# Gráfico 2: Solo las 10 variables principales
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 3:4,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
View(diccionario_variables)
# Gráfico 2: Solo las 10 variables principales
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 3,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
# Gráfico 2: Solo las 10 variables principales
factoextra::fviz_pca_var(pca_indicadores_post,
axes = 4:5,
fill.var = "contrib",
alpha.var = "contrib",
col.var = "contrib",
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = TRUE,
select.var = list(contrib = 10))
